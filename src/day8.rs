struct Image {
    width: usize,
    height: usize,
    layers: Vec<String>,
}

impl Image {
    fn new(mut pixels: String, width: usize, height: usize) -> Image {
        let layer_size = width * height;
        let num_layers = pixels.len() / layer_size;
        let mut layers = Vec::with_capacity(num_layers);

        for i in 0..num_layers {
            let layer = pixels.drain(..layer_size).collect();
            layers.push(layer);
        }
        Image {
            width,
            height,
            layers,
        }
    }
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_example() {
        let input = "123456789012";
        let image = Image::new(input.to_string(), 3, 2);
        assert_eq!(2, image.layers.len());
    }

    #[test]
    fn day_8_part_1() {
        let image = Image::new(get_puzzle_input().to_string(), 25, 6);
        let fewest_zeros = image
            .layers
            .iter()
            .min_by_key(|l| l.chars().filter(|c| *c == '0').count())
            .unwrap();
        let num_1s = fewest_zeros.chars().filter(|c| *c == '1').count();
        let num_2s = fewest_zeros.chars().filter(|c| *c == '2').count();
        assert_eq!(2460, num_1s * num_2s);
    }
}

fn get_puzzle_input() -> &'static str {
    "2022222200222222222212222\
     2202022222222222022212222\
     2202222222222002222222220\
     2222022222202022022020222\
     2222022120222222022222212\
     2222222022222221022222220\
     2022222201222222222212222\
     2212222222222222022222222\
     2202222222222202222222222\
     2222222222222022022222222\
     2222122022222222222222212\
     2222222122222221122222221\
     2222222201222222222212222\
     2202222222222222022202222\
     2222222222222222222222221\
     2222122222202022022220222\
     2222222122222222222222202\
     2222212122222222122222220\
     2022222220222222222212222\
     2212122222222222222202222\
     2202222222222002222222220\
     2222222222212122122221222\
     2222222222222222022222222\
     2222212122222222122222221\
     2222222210222222222222222\
     2212022222222222122222222\
     2202222222222212222222220\
     2222122222222122122122222\
     2222122021222222022222202\
     2222212122222222022222220\
     2122222211222222222202222\
     2212222222222222122202222\
     2212222222221122222222221\
     2222122222212122122022222\
     2222022122202222222212202\
     1222212222222221122202221\
     2022222222222222222212222\
     2222022222222222022212222\
     2212222222220012222222222\
     2222122222222222122021222\
     2222122021222222222222202\
     0222212122222222222202222\
     2022222212222222222212222\
     2222022222222222122222222\
     2202222220221222222222221\
     2222122222202122022020222\
     2222022222212222022212202\
     2222202122222220022212220\
     2122222202222222222202222\
     2202122222222222022222222\
     2202222222221212222222220\
     2222221222202222222121222\
     2222122122222222122202212\
     1222212122222220222212221\
     2022222202222222222202222\
     2212122222222222022222222\
     2202222221220222222222220\
     2222022222212022122221212\
     2222222220222222122222222\
     2222202022222221222222221\
     2122222222222222222222222\
     2212222222222222022222222\
     2222222222222012222222220\
     2222122222222122222022202\
     2222122022202222022212202\
     1222202222222220022212222\
     2222222212222222222212222\
     2202222222222222022202222\
     2202222220221022222222220\
     2222120222222122022021222\
     2222022122202222122212202\
     0222212022222221122212222\
     2222222221222222222212222\
     2202122222222222022212222\
     2222222222220102222222221\
     2222222222212022022122202\
     2222122020222222122222212\
     0222222122222222222212221\
     2122222212222222222202222\
     2202022222222222022202222\
     2202222222220002222222222\
     2222022222202222022220202\
     2222222222202222222222222\
     0222202222222220222202221\
     2122222221222222222222222\
     2222022222222222022212222\
     2222222220220222222222220\
     2222022222202022122122202\
     2222022120212222122220202\
     0222202022222221222212222\
     2222222222222222222212222\
     2212122222222222022222222\
     2212222222220212222222220\
     2222121222202022222121202\
     2222222121222222222222202\
     0222212222222220022212221\
     2222222200222222222202222\
     2212222222222222122212222\
     2222222221222202222222220\
     2222022222202222022021222\
     2222022021202222222222212\
     1222212222222222122202220\
     2222222212222222222222222\
     2212122222222222022212222\
     2202222221221022222022222\
     2222120222212222222220222\
     2222122220212222022200222\
     1222202222222222122202221\
     2222222210222222222202222\
     2212122222222222122222222\
     2222222222221012222222221\
     2222121222222222022220212\
     2222022022202222022212202\
     1222202212222221222212221\
     2222222211222222222202222\
     2202022222222222122212222\
     2212222222220202222122221\
     2222221222212222122221212\
     2222122221202202122200202\
     2222202102222221122212222\
     2122222200222222222202222\
     2202222222202222022202222\
     2202222221221012222222220\
     2222121222222122222221012\
     2222222220112202022212222\
     0222202212222222022222222\
     2122212221222222222212222\
     2202222222212222022212222\
     2202212221221222222222222\
     2222221222212222022121122\
     2222022021222212122211202\
     0222222222222222222222222\
     2022222221222222222222222\
     2212122222202222222222222\
     2202222220221122222022221\
     2222020222222022222120022\
     2222022020022212022201202\
     1222202222222220022212221\
     2122202201222222222222222\
     2222222222202222022202222\
     2222212220222122222222220\
     2222221222212221122022002\
     2222122020022202222220212\
     0222212122222220222221221\
     2022202220222122222212222\
     2212022222212222222222222\
     2202202220221212222122222\
     2222221222212121022022022\
     2222222122102202022221222\
     2222202102222220122211221\
     2122202222222022222202222\
     2212022222212222122202222\
     2212202222220102222122221\
     2222220222202121222021222\
     2222122121002222022222212\
     2222202122222222022222222\
     2222202211222222222202222\
     2222022222212222222222222\
     2202212222221022222122220\
     2222120222112222122121002\
     2222222221122222222221222\
     1222222122222221022201222\
     2122222210222222222222222\
     2202022022222222022212222\
     2212202221222122222222220\
     2222222222112121222022212\
     2222122222122222022220222\
     0222202012222220022211222\
     2222222212222122222202222\
     2212222022202222022222222\
     2212212222221102222222222\
     2222121222012121122122222\
     2222222121022222122221212\
     1222222112222221022220221\
     2222222200222222222212222\
     2222222122202222022222222\
     2222212222222111222022221\
     2222120222122121222022222\
     2222022222112222022200222\
     1222212222222221222212222\
     1022202200222122222212222\
     2212222022222222022222222\
     2222202220221100222022222\
     2222020222012122122221112\
     2222022220012002222220222\
     0222202022222221222211220\
     0222222212222222222202212\
     2222122022202222022202222\
     2212202222221222222122221\
     2222121222002121122221112\
     2222222122012022222200212\
     1222212002222220022222221\
     1222202202222222222212222\
     2212222222202222122212222\
     2222212220222012222022221\
     2222221222122122222021000\
     2222222020002202222202202\
     1222222022222220022202222\
     2222222220222022222212202\
     2222122122202222222212222\
     2222212221221112222022221\
     2222022220222221022221020\
     2222022220122022222211002\
     2222222012222221122222221\
     2222201202222222222212202\
     2222122022202222222202222\
     2202222222221200222122220\
     2222212202102121022220020\
     2222122120112212022220222\
     0222222112222221222221220\
     2222200202222122222202212\
     2222022222202222022202222\
     2202222220221200222222220\
     2222001221202122122121120\
     2222122021212222222221202\
     2222202222222221222202221\
     2122220211222022222212212\
     2202122022212222022222222\
     2212212220222112222222022\
     2222120220022220122121021\
     2222212221112212122222022\
     2212212202222222022200221\
     2122221221222021222202212\
     2222022022202222022222222\
     2222222220221111222222021\
     2222221200222121122120121\
     2222210022222212022202212\
     1202212002222221022221221\
     1122221201222221222202212\
     2202022222202222022202222\
     2222202221220020222022222\
     2222012220212020222121020\
     2222021121022112222222012\
     0222212022222221222211220\
     2222202200222021222222202\
     2222022022202222020222222\
     2222202220220212222122022\
     2222120201012122112220020\
     1222002022212002122200102\
     2212212012222220022212221\
     0222201201222222222212212\
     2222122222202222021202222\
     2212202220222112222222021\
     2222222210022220012121222\
     0222122222222012022211012\
     1212222212222221122220220\
     1022202221222020222212200\
     2202222222212222221222222\
     2212202220221221222222020\
     2222100210202121022122122\
     1222000021222202122200102\
     2212202212222221021202220\
     2122202201222021222212202\
     2222022122222222020212222\
     2212222221221100222022222\
     2222202211212120002022221\
     1222210222212102222212212\
     0212222102222222121211221\
     0122220201222021222202220\
     2212222022212222120202222\
     2212222220222201222022221\
     2222120222022021112221010\
     0222122221022202122200222\
     1202202022222222221220222\
     2122222211222120222212201\
     2212122122202222221222222\
     2222212221222021222222022\
     2222012210002021202221011\
     0222111221002002022220122\
     0222212112222221020222221\
     1022221220222220222202200\
     2202122122202222021222222\
     2222202222220222222022122\
     2222102212020221122222000\
     1222001021012202022210112\
     0222212102222222221212220\
     1222202222222020222212211\
     2212022022222222012212222\
     2222202222220112222022221\
     2222211222120120200022120\
     1222000122102212222220002\
     2212202202222222220202220\
     2022202201222021202212222\
     2222220222212222001202222\
     2222222220220212222122021\
     2222020222012020121120220\
     2222110222012202122222212\
     2202212022222222022202221\
     1222202212222120212212222\
     2202221022202222002202222\
     2212212221220201222222120\
     2222111201021221211121121\
     2222112122212112122200022\
     2222212122222220120202220\
     2022220211222200212212210\
     2212222022202222101202222\
     2202202222221221222222121\
     2222001210210220201120220\
     0222211020002002022211102\
     2222212102222221122210220\
     2222202220222021212202212\
     2212021122212222210202222\
     2212222222220200222222221\
     2222211202022221102022120\
     0222001020120122222211102\
     2202202112222220121212222\
     2222212202222201222202220\
     2212221122222222002222222\
     2202212222222100222022022\
     1222202212011222010020200\
     1222102220111022022211102\
     1222202112222222020211222\
     2122200210222022212222210\
     2212222122202222100202222\
     2222212222220010222222120\
     2222201220122121021122022\
     0222121122012022022202102\
     1212202222222220021211222\
     0022210221222002222212202\
     2222121222202222102202222\
     2222212222222010222022122\
     1222220201202220020022121\
     0222200222222122122210112\
     0212202202222221222212221\
     1122221202222210212212202\
     2202221122212222110222222\
     2202212222220121222122121\
     1222002220122021210022010\
     2222012001120122122222222\
     1222212112222222220200222\
     0122222211222112202212201\
     2202120122222222011222222\
     2202222221221222222222122\
     0222000222211120220021220\
     0222202011122002222202012\
     1212212222222222220221222\
     0222200201222111202012220\
     2222021222202222002222222\
     2222202221221222222222122\
     2222110200210120100220101\
     2222102100002122222200212\
     2212222122222220021201220\
     2022211221222121222122211\
     2202121022222222112202222\
     2212212220221201222122020\
     1222011222121022202120001\
     2222021100222012222201002\
     0222212002222220222220222\
     1222202200222002212102221\
     2202021222212222102202222\
     2222222222222022222022222\
     1222212122211221120222020\
     0222220102212122122221122\
     2201222112222222022212221\
     0222221201222212212112211\
     2222222222212222021202022\
     2202212220222122222022222\
     1222002202022221111221221\
     2222221221010122122200022\
     0211222102222222022211222\
     2122222220222020222102202\
     2202021122212222021222222\
     2222200222220021222222122\
     1222121201021221210120222\
     1222210002212202122210002\
     0200202112222220121222222\
     2222220211222122212222220\
     2202221122222222200222122\
     2222212222221112222122121\
     0222220201112220101121112\
     1222122100222022222221022\
     0212222112220222022220221\
     2222201210222111222202211\
     2202121112202222200202022\
     2222202220221100222122022\
     0222202001002021021220012\
     2222121101210212222220122\
     2211202122220221122200221\
     1222210222222201202122221\
     2202221202212222120212022\
     2222201222222021222122221\
     2222122001211122012120121\
     2222210101021022122222222\
     1201212122222221121200222\
     0122201200222110212022222\
     2222020022222222122202222\
     2212211222221211222222222\
     0222201210122020202020012\
     1222220211112102222202112\
     2201212202221221022220222\
     2122202222222011202012220\
     2212222222222222112212022\
     2202212222221101222022121\
     2222212110212220120022212\
     0222020022221122122211022\
     2210202002121222022222221\
     1022201212222222222222211\
     2212020202202222020202122\
     2202211222220021222122222\
     1222110001101122210121121\
     2222102122212202122220122\
     2212222012022220221201221\
     2022200221222201212122202\
     2212122122222222111212222\
     2202211222221211220122022\
     2222211022021220002120011\
     0222122202210012222221202\
     2200222022221222220200221\
     0022211220222012222002200\
     2202121102212222012212222\
     2202210222221201221122222\
     2222022220010120202020201\
     0222001212120202122200012\
     0210212102021220122212221\
     2122202222222112222022220\
     2222120012212222210202222\
     2212211220221012222222021\
     1222212220102220020121201\
     2222110001000012122212102\
     0201002202220222220211222\
     1222212202222011202022212\
     2222221112212202102212222\
     2212211222222212222022020\
     1222202200222122001020011\
     1222110010122122122210012\
     1220102202022221122202220\
     0222210220222000202102201\
     2202020022202202002202222\
     2202212222221000220222121\
     2220222200022022102121002\
     2222021000210202022201122\
     2201022202022222020222221\
     2022210220222200212112202\
     2202121202202202120202222\
     2012222220221202221022022\
     0220000220002222221020110\
     1222201010022111022200012\
     1212022202122221020220220\
     0022202200222210212222200\
     2202221022212222012222222\
     2002202220220101220222110\
     0221110012012220220121110\
     2222122210121110122220002\
     0210112102222221021210221\
     1022222221222000202212201\
     2222021112222202110212222\
     2022201222222001220022000\
     1220200000122220212020202\
     2022102000001200022222022\
     1212002222020221121221120\
     2122212221222012222012202\
     2222120122222202101202122\
     2212200220221100222122211\
     1222110000201222222221201\
     0122001010102012222201022\
     0222102022020220021202221\
     0022202212222221222012201\
     2202221212222222111212222\
     2122212220222210222012111\
     0220112111211122111021220\
     0022211012102120122200212\
     0202102112221221122210221\
     0022201220222200202012210\
     2002121020222202212202122\
     2122202222221221221002211\
     0220011212222022220121220\
     0022212112220100222220012\
     0212122202022221022200020\
     2122212212222101202112211\
     2212221011222202121222022\
     2112220220220221220102010\
     0222011222121221011222220\
     0022202102112112222212112\
     2202122002122222021222120\
     0122200200222202222202200\
     2122120110212202001222222\
     2012201221222101220002000\
     1220202220212221221121112\
     1022112001110012022201002\
     2220222022120221022201222\
     0222220220222021222222202\
     2002120021212222112212022\
     2122202222220221221112112\
     2222020012210021122022200\
     1002120012001100022210122\
     0212022212020221020221222\
     2122222220222111202102202\
     2002221201202212210212122\
     2122220222222122221122112\
     0220010200021120110220112\
     1212121200020201122201102\
     2200202122021222220212221\
     2022221211222120212102202\
     2102020200202201010202022\
     2222212222220110222102002\
     2221021011020022101021022\
     2222111001102110022200112\
     0202022012122221222221122\
     1022222200222200212002010\
     2112221222212222212222222\
     2022221221221101220002220\
     1222202101101122112221111\
     0002100110200111022202102\
     0122112102020222022200022\
     1022202210221021222102002\
     2012122111212221010212112\
     2012200221221112221022010\
     2221222000110220022021000\
     2012002011212000022221022\
     0022202002220220022210222\
     1222211202220112022112000\
     2010220001212212212202222\
     2022202222222100220002201\
     0222101101100120020222121\
     2212102202101211022210022\
     1000022112022220221222020\
     0222212211221020212212202\
     2012021202102211002212020\
     2102012220222012220222210\
     1221200121001121101021011\
     2102121101012001222210022\
     1102112112220221221202121\
     0222220222222212212002201\
     2020020022222221011212122\
     2022202220222200221112220\
     0220211121102221221020200\
     2122012112110202122222212\
     0011122202122220220211020\
     0122200201221121122212221\
     2011220212212201201212010\
     2122202220221000220022222\
     1220010122001222120120202\
     2012120212200220012220102\
     0202102122222221220220100\
     0122200222221022222012022\
     2222121101102220212222102\
     1010212221220200220202220\
     2220111201211220222122112\
     0222101202212012012201202\
     2100100122021220121211020\
     1120222210221020022012212\
     2010020111022221210202002\
     1100202221220202220202122\
     0221211002220120212122011\
     2202020012011021012202012\
     0211021122122222220222102\
     2121222202221221222022121\
     2112221012122201122222102\
     0002000221222101222022220\
     0220102000022222022222001\
     0012220111020222212210212\
     2021021002121220221221221\
     0120211221220012102222020\
     2222221001212211202222222\
     2200200222220112222012211\
     1221201021111121121220021\
     0002012002021210122222002\
     0010121200221222221201010\
     2121200210222200002122112\
     2010122002122220000212201\
     0010210222222211120002102\
     2222121100020222021121210\
     2122220100002120212220222\
     1101210100020221220200110\
     0221202211222020021002221\
     2121220120202222202202111\
     1111222221122220222012110\
     0221222212111121121221000\
     1222000220210210022210202\
     2010202211022221120201221\
     0221201201222012122012210\
     2020021022012222221212121\
     1001202220021112022122021\
     2220101002211221111120112\
     1012012201220002222202022\
     1110111110220221022200002\
     0220220212220002021002112\
     1222121202012200001202221\
     0020221221022020021002100\
     2220212221122022012220122\
     0102200122010122212221122\
     0022102112020220021221201\
     1122220100220221011112020\
     0110120120202022200222000\
     2200020221020022220122021\
     1202012202000221111122012\
     2002021112101020022222212\
     1221222012220222220212002\
     0221220221222210102122022\
     0212020122122112221222101\
     0212021221020211022020020\
     2211222202211222201121100\
     0122110102002012212202002\
     2212010020020222020211122\
     2100020010111122221020220\
     0211211001100010120010101\
     0212202012011010102002101\
     0002201102201001221012222\
     0220121211212201110011210\
     0210112112002002202022221"
}
